# Wlroots compositor startup script
#!/usr/bin/env bash

export WLR_RENDERER=vulkan
export XDG_SESSION_TYPE=wayland
export XDG_CURRENT_DESKTOP=sway
export _JAVA_AWT_WM_NONREPARENTING=1
export GDK_BACKEND=wayland,x11
export MOZ_ENABLE_WAYLAND=1
export QT_QPA_PLATFORM="wayland;xcb"
export QT_AUTO_SCREEN_SCALE_FACTOR=1
export QT_ENABLE_HIGHDPI_SCALING=1
export ELECTRON_OZONE_PLATFORM_HINT=auto

if lspci | grep -i nvidia > /dev/null; then 
	export GBM_BACKEND=nvidia-drm
	export __GLX_VENDOR_LIBRARY_NAME=nvidia
	export __GL_GSYNC_ALLOWED=1
	# requires libva-nvidia-driver
	export LIVBA_DRIVER_NAME=nvidia
	export NVD_BACKEND=direct
fi

#ssh-agent
export SSH_AUTH_SOCK="$XDG_RUNTIME_DIR/ssh-agent.socket"

env XDG_SESSION_TYPE=wayland XDG_CURRENT_DESKTOP=sway dbus-run-session sway --unsupported-gpu
